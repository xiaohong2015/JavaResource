作者：easyinfonet
email: zhujs@cec.gov.cn
日期：2001-2-23 9:39:16
6.6 用户简要表
    Application Server 含有 com.ibm.servlet.personalization.userprofile 软件包中的类，这些类使维护关于 Web 站点访问者的持久信息和利用这些信息来定制 Web 页面变得更为容易。UserProfile 类包括了访问者的完整名称、邮政地址和电子邮件地址、电话号码等数据成员，并含有用于存储所选的语言、职业和用户定义的组信息的字段。另外，它还含有类属信息、购物手推车和剪贴板（一个 Java 散列表）。这就使您很容易地将其它您选择的对象合并到这些数据中，并将它们作为 UserProfile 类的一部分进行处理。因为这些对象在用户简要表文件的后继实例一直存在，所以它们必须是可串行化的。如果使用了一个 JDBC 数据库，则会将对象存储在数据库中。否则，会将对象作为文件存储。在 Application Server 版本 2.0 中，UserProfile 类使用了数据库连接管理器来维护 JDBC 连接。
    可以使用“用户简要表文件”页面配置 UserProfile 类，该类用于定义和维护有关 Web 站点访问者的信息。UserProfile 类使用连接管理器来维护与 JDBC-从属数据库的连接。用户简要表文件的基本设置如下。 
1.	启用用户简要表文件
    (1) 查看“设置” -> “用户简要表文件”页面。 
	(2) 单击“启用”标签。 
	(3) 在“是否使用用户简要表文件?”字段中单击“是”。 
	(4) 对于“类名”字段，可以使用缺省值“com.ibm.servlet.personalization.userprofile.UserProfile” 或为 
UserProfile 类创建的扩展名。
	(5) 单击“保存”按钮。
    2．指定数据库信息
	(1) 查看“设置” -> “用户简要表文件”页面。 
   (2) 单击“数据库”标签。 
	(3) 指定数据库产品的名称（如 IBM DB2 的 db2）。 
	(4) 指定数据库的 JDBC 驱动程序（如 COM.ibm.db2.jdbc.app.DB2Driver）。注意：这包括 Application 
Server 的 Java 类路径中的驱动程序 .zip 或 .jar 文件（如 DB2 的 db2java.zip）。
	(5) 指定用户简要表文件的数据库名称以存储数据。如果不存在该数据库，将不会创建它。因此，可
以指定现有数据库的名称，或在使用该用户简要表文件之前用该名称创建一个数据库。无需在数据库中创建任何表格。 
	(6) 指定数据库的所有者，即创建数据库的用户的标识符。 
	(7) 指定保存用户简要表文件数据的数据库表格的名称。无需创建该表格，因为 UserProfile 类会在
初始化时创建它。 
	(8) 指定用于访问数据库和其表格的用户标识符。 
	(9) 指定与用户标识符相关的口令。 
   (10) 单击“保存”按钮。
    3．配置连接管理属性
	(1) 查看“设置” -> “用户简要表文件”页面。 
	(2) 单击“连接管理”标签。 
	(3) 指定要使用的连接缓冲池。 
	(4) 指定在“连接超时”指定的时间过后，连接仍不可用的情况下，指定是否等待并再试一次连接（与
“连接管理”页面中相同）。 
	(5) 单击“保存”按钮。 
UserProfile 类和 Application Server 的其余部分之间的唯一的耦合在于，UserProfile 类和 IBM 的会话实现（ IBMSessionData）含有同一个用户名称段，该用户名称段可用于在两个类之间创建一些增效作用。用户简要表文件对象持有关于用户的信息，并通过唯一的用户名与用户的 HttpSession 对象相关联。用户名的值由 SessionData类getUserName() 和 setUserName() 方法设置并返回。
也可以扩展 UserProfile 类以创建一个更适合业务需求的子类，并用 Application Server 管理器指定专门 UserProfile 子类，该子类可用于所有的 Web 应用程序。
