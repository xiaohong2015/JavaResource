作者：easyinfonet
email: zhujs@cec.gov.cn
日期：2001-2-23 9:39:57
6.7会话跟踪
Web应用服务器具有会话跟踪（即跟踪用户请求）的功能。使用管理器的“会话跟踪”页面配置会话跟踪。会话跟踪程序可将同一用户的几个相关请求合并为单个会话（即一个 HttpSession对象）。会话跟踪程序也能使Web应用服务器的多个实例能共享会话的一个公共缓冲池（即一个会话群集器）。
    1．启用会话跟踪及其部件 
查看 “会话跟踪”页面。单击“启用”标签。在“启用”标签中可以设置如下字段。
     (1) 启用会话：是否启用会话跟踪, 即请求和响应对象的相关会话方式是否有效。缺省值为是。 
	 (2) 启用 URL 重写：指会话跟踪是否启用重写 URL 来获取会话标识符。若被启用，则会话跟踪
程序将识别到达 URL 的会话标识符，若有必要的话，还将重写 URL 和发送该会话标识符。缺省值为。 
	 (3) 启用 Cookie：指会话跟踪是否使用 cookie 来携带会话标识符。若为“是”，则会话跟踪程序将
识别作为 cookie 到达的会话标识符，并用 cookie 作为发送会话标识符的方式。缺省值为是。
	 (4) 启用协议转换重写：当 URL 要求从 HTTP 转换成 HTTPS，或从 HTTPS 转换成 HTTP 时，
是否将会话标识符添加到 URL 中。缺省值为否。
    2．创建携带会话标识符的 Cookie
指定 Cookie 的设置，会话跟踪程序使用该 Cookie 将相关的个别请求置入逻辑用户会话中。当 Servlet 请求一个 HttpSession 对象表示一个用户会话时，会话跟踪程序可以使用一个 Cookie 将唯一的会话标识符传回给发出请求的浏览器。当 Servlet 发出后继请求时，Cookie 则获准在 Servlet 和会话跟踪程序间的往返传送。会话跟踪程序使用它来查找用户 Servlet 的现有 HttpSession 对象。换而言之，会话跟踪程序使用 Cookie 中的标识符确定该请求与该用户的其它请求相关。
查看 “会话跟踪”页面。单击“Cookie”标签。指定 Cookie 的名称，缺省值为sesessionid。可选地指定下列字段：
    (1) “域”字段的值以限制 Cookie 的发送位置。 
	(2) 会话 Cookie 在客户机浏览器上的活动时间（即“最长周期”字段，以毫秒计）。如果该字段为
空，则当关闭浏览器时将删除该 Cookie。 
	(3) “路径”字段的值以指定 Cookie 发送所至的服务器路径。 
	(4) 在“安全”字段中单击“是”以限制仅允许 HTTPS 会话的 Cookie 进行交换。
    3．设置会话跟踪活动的时限和参数
查看“会话跟踪”页面。单击“间隔”标签。 
    (1) 指定会话跟踪程序检查会话是否空闲及估计会话是否无效的时间间隔（以毫秒计）。 
    (2) 指定会话跟踪程序估计是否因为内存中会话过多，而将会话交换到磁盘的频率（以毫秒计）。 
	 (3) 指定一次允许保留在内存中的会话数（最多驻留数）。 
	 (4) 指定一个会话将允许在会话跟踪程序停止验证之前保持空闲的时间（以毫秒计）。
    4．保留持续数据
使用“持续性”标签指定在会话跟踪程序关闭重新并启动后，以验证会话数据是否交换到磁盘。如果“持续性”字段设置为否，则会话跟踪程序将在每次启动时删除旧的会话交换文件。查看“会话跟踪”页面。单击“持续性”标签。在“持续性”字段中单击“是”。指定会话跟踪程序用于存储要保持持续性的会话数据。注意：交换目录必须是一个空目录。
    5．指定会话群集和协议转换设置
可以将WebSphere应用服务器配置成以如下方式运行：独立主机、会话群集服务器、会话群集客户机、协议转换主机、独立主机。查看“会话跟踪”页面，单击“主机”标签。
    (1) 若WebSphere应用服务器实例为一个独立主机，则它不参与会话群集。在独立模式下, WebSphere应用服务器将维护它自己的会话信息，而对客户的会话信息请求将不予响应，并且不从服务器请求会话信息。缺省值：是。 
    (2) 在用如 IBM eNetwork Dispatcher 之类的产品群集 Web 服务器的环境中，指定WebSphere应用服务器实例的主机名和 IP 地址，其中该实例为会话群集服务器。
    (3) 若将WebSphere应用服务器实例配置成 URL 重写和协议转换（在“启用会话跟踪”标签中），则指明群集主机的主机名或 IP 地址。例如，可能为 IBM eNetwork Dispatcher 主机。
要使更改生效，请在更改“独立主机”或“会话群集服务器”字段后，重新启动Web应用服务器。更改这些字段后对所有配置所做的更改都保存在配置文件中，直至重新启动后方才生效。
